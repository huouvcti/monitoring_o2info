<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sensor Send page</title>
</head>
<body>
    <h1>sensor send page</h1>

    <br>

    <!-- PH, RTD, EC, DO -->
    <input type="text" name="Tc" placeholder="수온">
    <input type="text" name="DO" placeholder="DO">
    <input type="text" name="DO" placeholder="DO %">
    <input type="text" name="pH" placeholder="pH">
    <input type="text" name="Sa" placeholder="염도">
    <input type="text" name="ORP" placeholder="ORP">
    <input type="text" name="TUR" placeholder="탁도">

    <button onClick="sensor_click()">전송</button>

    <script>
        
    </script>
    

    <script src="/socket.io/socket.io.js"></script>
    <script>
        let url = "<%= parameters.url %>";
        const user_key = "<%= parameters.user_key %>";

        const socket = io.connect(url, {
            transports: ['websocket']
        });
        socket.emit('join', {room: user_key});

        let sensor;
        function sensor_click(){
            sensor = {
                PH: document.getElementsByName("PH")[0].value,
                RTD: document.getElementsByName("RTD")[0].value,
                SALT: document.getElementsByName("SALT")[0].value,
                DO: document.getElementsByName("DO")[0].value
            }
            console.log(sensor);
            socket.emit('sensor_send', sensor);
        }      

        socket.on('message', (data) => {
            console.log(data);
            document.getElementById('jo').innerText = data.wt;
        });
    </script>
</body>
</html>