<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>모니터링</title>


        <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/sidebars/">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" />


        <link rel="stylesheet" href="../../public/stylesheets/menuBar.css" />
        <link rel="stylesheet" href="../../public/stylesheets/monitoring.css"/>

        <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>

     </head>

    <body>

        <main class="d-flex flex-nowrap">

            <%-include('../lib/menuBar.ejs') %>

            <!-- sideBar -->
            <script>
                let menubar = document.getElementById("menuBar")
                menubar.children[0].children[0].className = "nav-link active";
            </script>


            <div class="b-example-divider b-example-vr" id="board" style="position:absolute; width: 95%; right: 0;">

                <h2 id="real-date" style="margin: 0 auto; text-align: center; font-weight: bold; margin-top: 2%;">clock</h2>

                
                
                <div id="dashboard" style="margin-top: 2%;">

                    <% let sensor_name = ["수온", "DO(mg/L)", "탁도", "pH", "염도", "ORP"] 
                            let sensor_id = ["high", "real", "low"] 
                            let sensor_unit = ["C", "mg/L", "%", "​", "​", "​"]
                            let color = ["#fa5252", "#52bafa", "#665d54", "#3c8f70", "#fa9852", "#71548c"] %>

                        <% for (let i=0; i<6; i++){ %>
                                
                            <div id="<%= sensor_id[i] %>" class="big_grid">

                                <div class="dash_each">
                                    
                                    <h5 class="sensor_name" style="background-color: <%= color[i] %>;"><%= sensor_name[i] %></h5>

                                    <div class="dash_info">

                                        <div class="other_info">

                                            <div class="info_text">최고 임계치</div>
                                            <p class="other_info_num"><span id="sensor_id[0]"></span><%= sensor_unit[i] %></p>
        
                                            <div class="info_text">최저 임계치</div>
                                            <p class="other_info_num"><span id="sensor_id[2]"></span><%= sensor_unit[i] %></p>
        
                                            <!-- <p class="card-text"><small class="text-muted" style="margin:0%; padding:0%   ">최고 임계치</small></p> -->
                                        </div>

                                        <div class="real_info" style="color: <%= color[i] %>;">
                                            <p><span id="sensor_id[1]"></span><%= sensor_unit[i] %></p>
                                        </div>

                                        <div class="progress_bar">
                                            진행바
                                        </div>
                                        
                                    </div>

                                </div>

                            </div>
                        <% } %>
                        
                </div> 

                <script src="/monitoring_o2info/middleware/socketio.js"></script>

                <script>
                    socket.on('sensor_before', async (data) => {
                        
                        let sensors = [RTD, DOMG, PH, SALT, ORP, turbidity]

                        for(let i=0; i<6; i++){
                            document.getElementById("sensor_id").innerText = data[sensors[i]]
                            
                        }

                    })
                </script>


            </div>

            <!-- 날짜, 시간 불러옴 -->
            <script>
                const real_date = document.getElementById("real-date")
                function clock() {
                    var time = new Date();

                    var month = time.getMonth();
                    var date = time.getDate();
                    var day = time.getDay();
                    var week = ['일', '월', '화', '수', '목', '금', '토'];

                    var hours = time.getHours();
                    var min = time.getMinutes();
                    var sec = time.getSeconds();

                    // real_date.innerText = `${month+1}월 ${date}일 ${week[day]}요일`;
                    real_date.innerText = 
            `${month + 1}월 ${date}일 ${week[day]}요일 ` +
            `${hours < 10 ? `0${hours}` : hours}:${min < 10 ? `0${min}` : min}:${sec < 10 ? `0${sec}` : sec}`;
                    
                }

                clock();
                setInterval(clock, 1000);
            </script>


            <!-- <script src="../../public/javascripts/menubar.js"></script> -->

        </main> 

    </body>
</html>